apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.name }}-configmap
  namespace: {{ .Values.namespace }}
  annotations:
    reloader.stakater.com/auto: "true"
data:
  config.yml: |
    ports:
      http: {{ .Values.deployment.ports.http }}
    prometheus:
      enable: true
    upstreams:
      timeout: 5s
      groups:
        default:
          - https://dns.quad9.net/dns-query
          - https://security.cloudflare-dns.com/dns-query
    bootstrapDns:
      - upstream: https://dns.quad9.net/dns-query
        ips:
          - 9.9.9.9
          - 149.112.112.112
      - upstream: https://security.cloudflare-dns.com/dns-query
        ips:
          - 1.1.1.2
          - 1.0.0.2
    blocking:
      denylists:
        ads:
          - https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
          - https://badmojr.gitlab.io/1hosts/Pro/domains.txt
          - https://big.oisd.nl/domainswild
          - https://raw.githubusercontent.com/siutsin/GoodbyeAds/refs/heads/master-patched/Hosts/GoodbyeAds.txt
          - https://raw.githubusercontent.com/hagezi/dns-blocklists/main/hosts/pro.txt
      clientGroupsBlock:
        default:
          - ads
      blockType: zeroIp
      loading:
        concurrency: 10
        maxErrorsPerSource: 50
        downloads:
          timeout: 10m
          attempts: 5
          cooldown: 10s
